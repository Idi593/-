<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Робот, танцующий под бит музыки</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            width: 100%;
            max-width: 1000px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #ff6b6b, #ffd166);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 5px 15px rgba(255, 107, 107, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #a0aec0;
            margin-bottom: 20px;
        }
        
        .highlight {
            color: #ffd166;
            font-weight: bold;
        }
        
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            width: 100%;
            max-width: 1200px;
        }
        
        .robot-container {
            flex: 1;
            min-width: 300px;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .robot {
            position: relative;
            width: 280px;
            height: 400px;
            margin-bottom: 30px;
        }
        
        .robot-body {
            position: absolute;
            width: 200px;
            height: 250px;
            background: linear-gradient(to bottom, #2d3748, #4a5568);
            border-radius: 40% 40% 30% 30%;
            top: 100px;
            left: 40px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            border: 5px solid #718096;
            z-index: 2;
        }
        
        .robot-head {
            position: absolute;
            width: 160px;
            height: 120px;
            background: linear-gradient(to bottom, #4a5568, #2d3748);
            border-radius: 40% 40% 30% 30%;
            top: 30px;
            left: 60px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            border: 5px solid #718096;
            z-index: 3;
        }
        
        .robot-eye {
            position: absolute;
            width: 40px;
            height: 40px;
            background-color: #00ffff;
            border-radius: 50%;
            top: 40px;
            box-shadow: 0 0 20px #00ffff;
            animation: blink 5s infinite;
        }
        
        .left-eye {
            left: 30px;
        }
        
        .right-eye {
            right: 30px;
        }
        
        .robot-mouth {
            position: absolute;
            width: 80px;
            height: 20px;
            background-color: #ff6b6b;
            border-radius: 10px;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 10px;
        }
        
        .tooth {
            width: 8px;
            height: 10px;
            background-color: #fff;
        }
        
        .robot-arm {
            position: absolute;
            width: 80px;
            height: 30px;
            background: linear-gradient(to bottom, #4a5568, #2d3748);
            border-radius: 15px;
            z-index: 1;
        }
        
        .left-arm {
            top: 150px;
            left: -40px;
            transform-origin: right center;
        }
        
        .right-arm {
            top: 150px;
            right: -40px;
            transform-origin: left center;
        }
        
        .robot-leg {
            position: absolute;
            width: 40px;
            height: 120px;
            background: linear-gradient(to bottom, #2d3748, #4a5568);
            border-radius: 0 0 20px 20px;
            bottom: 0;
            border: 3px solid #718096;
            transform-origin: top center;
        }
        
        .left-leg {
            left: 70px;
        }
        
        .right-leg {
            right: 70px;
        }
        
        .antenna {
            position: absolute;
            width: 6px;
            height: 40px;
            background-color: #ff6b6b;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 3px 3px 0 0;
        }
        
        .antenna-ball {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: #00ffff;
            border-radius: 50%;
            top: -50px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 10px #00ffff;
        }
        
        .speaker {
            position: absolute;
            width: 60px;
            height: 60px;
            background-color: #2d3748;
            border-radius: 10px;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            align-items: center;
            border: 3px solid #718096;
            z-index: 4;
        }
        
        .speaker-grid {
            width: 80%;
            height: 80%;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 3px;
        }
        
        .speaker-dot {
            background-color: #4a5568;
            border-radius: 1px;
        }
        
        .beat-indicator {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #ff6b6b;
            border-radius: 50%;
            top: 20px;
            right: 20px;
            box-shadow: 0 0 10px #ff6b6b;
            z-index: 5;
            opacity: 0;
        }
        
        .controls {
            flex: 1;
            min-width: 300px;
            max-width: 500px;
            background-color: rgba(45, 55, 72, 0.7);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
        }
        
        .controls h2 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: #ffd166;
            text-align: center;
        }
        
        .control-group {
            margin-bottom: 25px;
        }
        
        .control-group h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #a0aec0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-group h3 i {
            color: #ffd166;
        }
        
        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .btn {
            padding: 12px 20px;
            background-color: #4a5568;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: #2d3748;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .btn.active {
            background-color: #ff6b6b;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
        }
        
        .btn.music {
            background-color: #9d4edd;
        }
        
        .btn.music:hover {
            background-color: #7b2cbf;
            box-shadow: 0 5px 15px rgba(157, 78, 221, 0.3);
        }
        
        .btn.music.active {
            background-color: #c77dff;
            box-shadow: 0 0 15px rgba(199, 125, 255, 0.7);
        }
        
        .btn.upload {
            background-color: #4ade80;
        }
        
        .btn.upload:hover {
            background-color: #22c55e;
            box-shadow: 0 5px 15px rgba(74, 222, 128, 0.3);
        }
        
        .btn.beat {
            background-color: #ffd166;
            color: #1a1a2e;
        }
        
        .btn.beat:hover {
            background-color: #ffc233;
            box-shadow: 0 5px 15px rgba(255, 209, 102, 0.3);
        }
        
        .btn.beat.active {
            background-color: #ffb347;
            box-shadow: 0 0 15px rgba(255, 179, 71, 0.7);
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .slider-container label {
            min-width: 120px;
            font-weight: 600;
        }
        
        .slider {
            flex: 1;
            -webkit-appearance: none;
            height: 10px;
            background: #4a5568;
            border-radius: 5px;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: #ff6b6b;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.8);
        }
        
        .music-player {
            background-color: rgba(26, 32, 44, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #9d4edd;
        }
        
        .music-player h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #c77dff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .track-info {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 15px;
        }
        
        .album-cover {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            background: linear-gradient(135deg, #9d4edd, #c77dff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 5px 15px rgba(157, 78, 221, 0.5);
        }
        
        .track-details {
            flex: 1;
        }
        
        .track-title {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #fff;
        }
        
        .track-artist {
            color: #a0aec0;
            font-size: 0.9rem;
        }
        
        .music-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .music-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #4a5568;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .music-btn:hover {
            background-color: #9d4edd;
            transform: scale(1.1);
        }
        
        .music-btn.play-pause {
            width: 60px;
            height: 60px;
            background-color: #9d4edd;
            font-size: 1.5rem;
        }
        
        .music-btn.play-pause:hover {
            background-color: #c77dff;
        }
        
        .progress-container {
            margin: 15px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: #4a5568;
            border-radius: 3px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #ff6b6b, #ffd166);
            width: 0%;
            transition: width 0.1s;
        }
        
        .time-info {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9rem;
            color: #a0aec0;
        }
        
        .beat-detector {
            background-color: rgba(26, 32, 44, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #ffd166;
        }
        
        .beat-detector h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #ffd166;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .beat-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .beat-stat {
            flex: 1;
            min-width: 120px;
            background-color: rgba(45, 55, 72, 0.5);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
        }
        
        .beat-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd166;
            margin-bottom: 5px;
        }
        
        .beat-stat-label {
            font-size: 0.9rem;
            color: #a0aec0;
        }
        
        .beat-visualizer {
            height: 60px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .beat-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background-color: rgba(255, 209, 102, 0.5);
            top: 50%;
            transform: translateY(-50%);
        }
        
        .beat-pulse {
            position: absolute;
            width: 10px;
            height: 40px;
            background-color: #ff6b6b;
            border-radius: 5px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
        }
        
        .visualizer {
            height: 100px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .visualizer-bars {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 100%;
            padding: 0 10px;
        }
        
        .visualizer-bar {
            width: 8px;
            background: linear-gradient(to top, #ff6b6b, #ffd166);
            border-radius: 4px 4px 0 0;
            transition: height 0.1s ease;
        }
        
        .upload-container {
            background-color: rgba(26, 32, 44, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #4ade80;
        }
        
        .upload-container h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #4ade80;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .upload-area {
            border: 2px dashed #4a5568;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .upload-area:hover {
            border-color: #4ade80;
            background-color: rgba(74, 222, 128, 0.1);
        }
        
        .upload-area.dragover {
            border-color: #4ade80;
            background-color: rgba(74, 222, 128, 0.2);
        }
        
        .upload-area i {
            font-size: 3rem;
            color: #4ade80;
            margin-bottom: 10px;
        }
        
        .upload-area p {
            margin-bottom: 10px;
        }
        
        .file-input {
            display: none;
        }
        
        .file-list {
            max-height: 150px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background-color: rgba(45, 55, 72, 0.5);
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .file-item:hover {
            background-color: rgba(45, 55, 72, 0.8);
        }
        
        .file-item.active {
            background-color: rgba(255, 107, 107, 0.3);
            border-left: 3px solid #ff6b6b;
        }
        
        .file-item i {
            color: #ff6b6b;
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .file-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .file-duration {
            color: #a0aec0;
            font-size: 0.9rem;
            margin-left: 10px;
        }
        
        .status {
            background-color: rgba(26, 32, 44, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border-left: 5px solid #00b4db;
        }
        
        .status h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #00ffff;
        }
        
        .status p {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .status-value {
            color: #ffd166;
            font-weight: 600;
        }
        
        .footer {
            margin-top: 40px;
            text-align: center;
            color: #a0aec0;
            font-size: 0.9rem;
            width: 100%;
            max-width: 1000px;
            padding-top: 20px;
            border-top: 1px solid #2d3748;
        }
        
        @keyframes blink {
            0%, 94%, 100% {
                height: 40px;
            }
            95%, 99% {
                height: 5px;
            }
        }
        
        @keyframes beat-pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }
        
        @keyframes arm-swing-left {
            0%, 100% {
                transform: rotate(30deg);
            }
            50% {
                transform: rotate(-20deg);
            }
        }
        
        @keyframes arm-swing-right {
            0%, 100% {
                transform: rotate(-30deg);
            }
            50% {
                transform: rotate(20deg);
            }
        }
        
        @keyframes leg-lift-left {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(-15deg);
            }
        }
        
        @keyframes leg-lift-right {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(15deg);
            }
        }
        
        @keyframes body-bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        @keyframes head-bob {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }
        
        @keyframes eye-beat {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 20px #00ffff;
            }
            50% {
                transform: scale(1.2);
                box-shadow: 0 0 40px #00ffff;
            }
        }
        
        @keyframes speaker-pulse {
            0%, 100% {
                transform: translateX(-50%) scale(1);
                box-shadow: 0 0 0 rgba(157, 78, 221, 0.4);
            }
            50% {
                transform: translateX(-50%) scale(1.05);
                box-shadow: 0 0 20px rgba(157, 78, 221, 0.8);
            }
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }
            
            .robot-container, .controls {
                max-width: 100%;
            }
            
            h1 {
                font-size: 2.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-robot"></i> Робот, танцующий под бит музыки</h1>
        <p class="subtitle">Загрузите музыку и робот будет <span class="highlight">танцевать в такт битам!</span></p>
    </div>
    
    <div class="container">
        <div class="robot-container">
            <div class="robot" id="robot">
                <div class="robot-head" id="robot-head">
                    <div class="antenna"></div>
                    <div class="antenna-ball"></div>
                    <div class="robot-eye left-eye" id="left-eye"></div>
                    <div class="robot-eye right-eye" id="right-eye"></div>
                    <div class="robot-mouth">
                        <div class="tooth"></div>
                        <div class="tooth"></div>
                        <div class="tooth"></div>
                        <div class="tooth"></div>
                    </div>
                </div>
                <div class="robot-body" id="robot-body"></div>
                <div class="speaker" id="speaker">
                    <div class="speaker-grid" id="speaker-grid">
                        <div class="speaker-dot"></div>
                        <div class="speaker-dot"></div>
                        <div class="speaker-dot"></div>
                        <div class="speaker-dot"></div>
                        <div class="speaker-dot"></div>
                        <div class="speaker-dot"></div>
                        <div class="speaker-dot"></div>
                        <div class="speaker-dot"></div>
                        <div class="speaker-dot"></div>
                    </div>
                </div>
                <div class="beat-indicator" id="beat-indicator"></div>
                <div class="robot-arm left-arm" id="left-arm"></div>
                <div class="robot-arm right-arm" id="right-arm"></div>
                <div class="robot-leg left-leg" id="left-leg"></div>
                <div class="robot-leg right-leg" id="right-leg"></div>
            </div>
        </div>
        
        <div class="controls">
            <h2><i class="fas fa-gamepad"></i> Панель управления</h2>
            
            <div class="control-group">
                <h3><i class="fas fa-running"></i> Режимы танца</h3>
                <div class="buttons">
                    <button class="btn beat" id="auto-beat-btn">
                        <i class="fas fa-heartbeat"></i> Авто-бит
                    </button>
                    <button class="btn" id="manual-dance-btn">
                        <i class="fas fa-user"></i> Ручной танец
                    </button>
                    <button class="btn" id="crazy-dance-btn">
                        <i class="fas fa-fire"></i> Безумный танец
                    </button>
                </div>
            </div>
            
            <div class="beat-detector">
                <h3><i class="fas fa-heartbeat"></i> Детектор битов</h3>
                
                <div class="beat-info">
                    <div class="beat-stat">
                        <div class="beat-stat-value" id="bpm-value">0</div>
                        <div class="beat-stat-label">BPM</div>
                    </div>
                    <div class="beat-stat">
                        <div class="beat-stat-value" id="beat-count">0</div>
                        <div class="beat-stat-label">Битов</div>
                    </div>
                    <div class="beat-stat">
                        <div class="beat-stat-value" id="energy-level">0%</div>
                        <div class="beat-stat-label">Энергия</div>
                    </div>
                </div>
                
                <div class="beat-visualizer">
                    <div class="beat-line"></div>
                    <div class="beat-pulse" id="beat-pulse"></div>
                </div>
            </div>
            
            <div class="upload-container">
                <h3><i class="fas fa-upload"></i> Загрузить музыку</h3>
                
                <div class="upload-area" id="upload-area">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Перетащите сюда файлы музыки или</p>
                    <button class="btn upload" id="select-files-btn">
                        <i class="fas fa-folder-open"></i> Выбрать файлы
                    </button>
                    <p style="font-size: 0.9rem; margin-top: 10px; color: #a0aec0;">
                        Поддерживаемые форматы: MP3, WAV, OGG, M4A
                    </p>
                </div>
                
                <input type="file" id="file-input" class="file-input" multiple accept="audio/*">
                
                <div class="file-list" id="file-list">
                    <!-- Список загруженных файлов будет здесь -->
                </div>
            </div>
            
            <div class="music-player">
                <h3><i class="fas fa-music"></i> Музыкальный плеер</h3>
                
                <div class="track-info">
                    <div class="album-cover" id="album-cover">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="track-details">
                        <div class="track-title" id="track-title">Загрузите свою музыку</div>
                        <div class="track-artist" id="track-artist">Робот будет танцевать под бит!</div>
                    </div>
                </div>
                
                <div class="music-controls">
                    <button class="music-btn" id="prev-btn">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="music-btn play-pause" id="play-pause-btn">
                        <i class="fas fa-play" id="play-icon"></i>
                    </button>
                    <button class="music-btn" id="next-btn">
                        <i class="fas fa-step-forward"></i>
                    </button>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <div class="time-info">
                        <span id="current-time">0:00</span>
                        <span id="duration">0:00</span>
                    </div>
                </div>
                
                <div class="slider-container">
                    <div class="volume-container">
                        <i class="fas fa-volume-up"></i>
                        <input type="range" min="0" max="100" value="70" class="slider" id="volume-slider">
                    </div>
                </div>
                
                <div class="visualizer">
                    <div class="visualizer-bars" id="visualizer-bars"></div>
                </div>
            </div>
            
            <div class="control-group">
                <h3><i class="fas fa-sliders-h"></i> Настройки танца</h3>
                <div class="slider-container">
                    <label for="sensitivity-slider">Чувствительность:</label>
                    <input type="range" min="1" max="10" value="5" class="slider" id="sensitivity-slider">
                </div>
                <div class="slider-container">
                    <label for="intensity-slider">Интенсивность:</label>
                    <input type="range" min="1" max="10" value="5" class="slider" id="intensity-slider">
                </div>
            </div>
            
            <div class="status">
                <h3><i class="fas fa-info-circle"></i> Информация</h3>
                <p>Режим: <span class="status-value" id="dance-mode">Ожидание музыки</span></p>
                <p>Биты в минуту: <span class="status-value" id="bpm-display">0</span></p>
                <p>Текущий трек: <span class="status-value" id="current-track">Нет</span></p>
                <p>Статус: <span class="status-value" id="robot-status">Готов к танцу!</span></p>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>Робот с детектором битов | Анализирует музыку и танцует в такт | Создано с использованием HTML, CSS и JavaScript</p>
        <p>© 2023 Робот-танцор. Все права защищены.</p>
    </div>

    <!-- Аудио элемент для воспроизведения музыки -->
    <audio id="audio-player"></audio>

    <script>
        // Получаем элементы робота
        const robot = document.getElementById('robot');
        const robotHead = document.getElementById('robot-head');
        const robotBody = document.getElementById('robot-body');
        const leftArm = document.getElementById('left-arm');
        const rightArm = document.getElementById('right-arm');
        const leftLeg = document.getElementById('left-leg');
        const rightLeg = document.getElementById('right-leg');
        const leftEye = document.getElementById('left-eye');
        const rightEye = document.getElementById('right-eye');
        const speaker = document.getElementById('speaker');
        const speakerGrid = document.getElementById('speaker-grid');
        const beatIndicator = document.getElementById('beat-indicator');
        
        // Получаем элементы управления
        const autoBeatBtn = document.getElementById('auto-beat-btn');
        const manualDanceBtn = document.getElementById('manual-dance-btn');
        const crazyDanceBtn = document.getElementById('crazy-dance-btn');
        const sensitivitySlider = document.getElementById('sensitivity-slider');
        const intensitySlider = document.getElementById('intensity-slider');
        
        // Получаем элементы музыкального плеера
        const playPauseBtn = document.getElementById('play-pause-btn');
        const playIcon = document.getElementById('play-icon');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const volumeSlider = document.getElementById('volume-slider');
        const progressBar = document.getElementById('progress-bar');
        const progress = document.getElementById('progress');
        const currentTimeEl = document.getElementById('current-time');
        const durationEl = document.getElementById('duration');
        const visualizerBars = document.getElementById('visualizer-bars');
        const trackTitle = document.getElementById('track-title');
        const trackArtist = document.getElementById('track-artist');
        const albumCover = document.getElementById('album-cover');
        
        // Получаем элементы детектора битов
        const bpmValue = document.getElementById('bpm-value');
        const beatCount = document.getElementById('beat-count');
        const energyLevel = document.getElementById('energy-level');
        const beatPulse = document.getElementById('beat-pulse');
        
        // Получаем элементы загрузки файлов
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('file-input');
        const selectFilesBtn = document.getElementById('select-files-btn');
        const fileList = document.getElementById('file-list');
        
        // Получаем элементы статуса
        const danceMode = document.getElementById('dance-mode');
        const bpmDisplay = document.getElementById('bpm-display');
        const currentTrack = document.getElementById('current-track');
        const robotStatus = document.getElementById('robot-status');
        
        // Аудио элемент
        const audioPlayer = document.getElementById('audio-player');
        
        // Переменные состояния
        let isMusicPlaying = false;
        let currentTrackIndex = 0;
        let currentDanceMode = 'auto'; // auto, manual, crazy
        let sensitivity = 5;
        let intensity = 5;
        
        // Переменные для детектора битов
        let beatDetectionInterval;
        let lastBeatTime = 0;
        let beatTimes = [];
        let beatCounter = 0;
        let bpm = 0;
        let energy = 0;
        let isBeat = false;
        
        // Плейлист с загруженными треками
        let playlist = [];
        
        // Аудиоконтекст для анализатора
        let audioContext;
        let analyser;
        let source;
        let dataArray;
        let bufferLength;
        let beatCheckInterval;
        
        // Инициализация визуализатора
        function initVisualizer() {
            visualizerBars.innerHTML = '';
            for (let i = 0; i < 32; i++) {
                const bar = document.createElement('div');
                bar.className = 'visualizer-bar';
                bar.style.height = `${Math.random() * 30 + 10}px`;
                visualizerBars.appendChild(bar);
            }
        }
        
        // Инициализация аудиоанализатора
        function initAudioAnalyzer() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                source = audioContext.createMediaElementSource(audioPlayer);
                source.connect(analyser);
                analyser.connect(audioContext.destination);
                
                analyser.fftSize = 256;
                bufferLength = analyser.frequencyBinCount;
                dataArray = new Uint8Array(bufferLength);
            }
        }
        
        // Обновление визуализатора на основе аудиоданных
        function updateVisualizer() {
            if (!analyser || !isMusicPlaying) return;
            
            analyser.getByteFrequencyData(dataArray);
            const bars = document.querySelectorAll('.visualizer-bar');
            
            // Обновляем высоту столбцов визуализатора
            bars.forEach((bar, index) => {
                const barIndex = Math.floor(index * bufferLength / bars.length);
                let value = dataArray[barIndex];
                
                // Усиливаем низкие частоты для лучшего отображения битов
                if (barIndex < 5) {
                    value = value * 1.5;
                }
                
                const height = Math.min(value / 2 + 10, 100);
                bar.style.height = `${height}px`;
                
                // Цвет в зависимости от частоты и энергии
                const hue = 30 + (barIndex / bufferLength * 30); // От желтого к красному
                bar.style.background = `linear-gradient(to top, hsl(${hue}, 100%, 60%), hsl(${hue + 20}, 100%, 70%))`;
            });
            
            // Детектирование битов
            detectBeat();
        }
        
        // Детектирование битов
        function detectBeat() {
            if (!analyser) return;
            
            // Получаем данные о низких частотах (басы)
            let sum = 0;
            for (let i = 0; i < 10; i++) {
                sum += dataArray[i];
            }
            const average = sum / 10;
            
            // Вычисляем энергию
            energy = average;
            energyLevel.textContent = `${Math.min(100, Math.round(energy / 2.55))}%`;
            
            // Проверяем, является ли это битом
            const threshold = 100 + (sensitivity * 10);
            const currentTime = Date.now();
            
            if (average > threshold && !isBeat && (currentTime - lastBeatTime > 200)) {
                // Найден бит!
                isBeat = true;
                lastBeatTime = currentTime;
                beatCounter++;
                beatCount.textContent = beatCounter;
                
                // Записываем время бита для расчета BPM
                beatTimes.push(currentTime);
                if (beatTimes.length > 10) {
                    beatTimes.shift();
                }
                
                // Рассчитываем BPM
                if (beatTimes.length > 1) {
                    const timeDifferences = [];
                    for (let i = 1; i < beatTimes.length; i++) {
                        timeDifferences.push(beatTimes[i] - beatTimes[i-1]);
                    }
                    const averageDifference = timeDifferences.reduce((a, b) => a + b) / timeDifferences.length;
                    bpm = Math.round(60000 / averageDifference);
                    bpmValue.textContent = bpm;
                    bpmDisplay.textContent = bpm;
                }
                
                // Запускаем анимацию бита
                triggerBeatAnimation();
                
                // Запускаем танец в такт биту
                danceToBeat();
                
                // Сбрасываем флаг бита через короткое время
                setTimeout(() => {
                    isBeat = false;
                }, 100);
            }
            
            // Обновляем позицию пульса на визуализаторе битов
            updateBeatPulse(average);
        }
        
        // Обновление позиции пульса на визуализаторе битов
        function updateBeatPulse(average) {
            const maxEnergy = 255;
            const position = (average / maxEnergy) * 100;
            beatPulse.style.left = `${position}%`;
            beatPulse.style.opacity = average / 300;
            beatPulse.style.height = `${20 + (average / 5)}px`;
        }
        
        // Анимация бита
        function triggerBeatAnimation() {
            // Анимация индикатора бита
            beatIndicator.style.animation = 'none';
            beatIndicator.offsetHeight; // Триггер перерисовки
            beatIndicator.style.animation = 'beat-pulse 0.3s';
            
            // Анимация пульса на визуализаторе
            beatPulse.style.animation = 'none';
            beatPulse.offsetHeight;
            beatPulse.style.animation = 'beat-pulse 0.3s';
            
            // Мигание глаз
            leftEye.style.animation = 'eye-beat 0.3s, blink 5s infinite';
            rightEye.style.animation = 'eye-beat 0.3s, blink 5s infinite';
        }
        
        // Танец в такт биту
        function danceToBeat() {
            if (currentDanceMode === 'auto') {
                autoBeatDance();
            } else if (currentDanceMode === 'crazy') {
                crazyDance();
            }
            // В ручном режиме танцуем только при нажатии кнопок
        }
        
        // Автоматический танец под бит
        function autoBeatDance() {
            const intensityFactor = intensity / 10;
            
            // Случайно выбираем тип движения
            const moveType = Math.floor(Math.random() * 4);
            
            switch(moveType) {
                case 0: // Качание телом
                    robotBody.style.animation = 'none';
                    robotBody.offsetHeight;
                    robotBody.style.animation = `body-bounce ${0.5 / intensityFactor}s`;
                    break;
                    
                case 1: // Качание головой
                    robotHead.style.animation = 'none';
                    robotHead.offsetHeight;
                    robotHead.style.animation = `head-bob ${0.4 / intensityFactor}s`;
                    break;
                    
                case 2: // Движение руками
                    leftArm.style.animation = 'none';
                    rightArm.style.animation = 'none';
                    leftArm.offsetHeight;
                    rightArm.offsetHeight;
                    
                    leftArm.style.animation = `arm-swing-left ${0.6 / intensityFactor}s`;
                    rightArm.style.animation = `arm-swing-right ${0.6 / intensityFactor}s`;
                    break;
                    
                case 3: // Движение ногами
                    leftLeg.style.animation = 'none';
                    rightLeg.style.animation = 'none';
                    leftLeg.offsetHeight;
                    rightLeg.offsetHeight;
                    
                    // Чередуем ноги
                    if (beatCounter % 2 === 0) {
                        leftLeg.style.animation = `leg-lift-left ${0.5 / intensityFactor}s`;
                    } else {
                        rightLeg.style.animation = `leg-lift-right ${0.5 / intensityFactor}s`;
                    }
                    break;
            }
            
            // Анимация динамика
            speaker.style.animation = 'none';
            speaker.offsetHeight;
            speaker.style.animation = `speaker-pulse ${0.3 / intensityFactor}s`;
            
            // Анимация точек на динамике
            const dots = speakerGrid.querySelectorAll('.speaker-dot');
            dots.forEach((dot, index) => {
                dot.style.animation = 'none';
                dot.offsetHeight;
                dot.style.animation = `glow ${(0.2 + index * 0.05) / intensityFactor}s`;
                dot.style.backgroundColor = getBeatColor();
            });
        }
        
        // Безумный танец (все движения сразу)
        function crazyDance() {
            const intensityFactor = intensity / 5; // Еще более интенсивно
            
            // Все части тела двигаются одновременно
            robotBody.style.animation = 'none';
            robotHead.style.animation = 'none';
            leftArm.style.animation = 'none';
            rightArm.style.animation = 'none';
            leftLeg.style.animation = 'none';
            rightLeg.style.animation = 'none';
            
            robotBody.offsetHeight;
            robotHead.offsetHeight;
            leftArm.offsetHeight;
            rightArm.offsetHeight;
            leftLeg.offsetHeight;
            rightLeg.offsetHeight;
            
            robotBody.style.animation = `body-bounce ${0.3 / intensityFactor}s`;
            robotHead.style.animation = `head-bob ${0.25 / intensityFactor}s`;
            leftArm.style.animation = `arm-swing-left ${0.4 / intensityFactor}s`;
            rightArm.style.animation = `arm-swing-right ${0.4 / intensityFactor}s`;
            
            // Ноги двигаются в противофазу
            if (beatCounter % 2 === 0) {
                leftLeg.style.animation = `leg-lift-left ${0.35 / intensityFactor}s`;
                rightLeg.style.animation = `leg-lift-right ${0.35 / intensityFactor}s 0.175s`;
            } else {
                rightLeg.style.animation = `leg-lift-right ${0.35 / intensityFactor}s`;
                leftLeg.style.animation = `leg-lift-left ${0.35 / intensityFactor}s 0.175s`;
            }
            
            // Интенсивная анимация динамика
            speaker.style.animation = 'none';
            speaker.offsetHeight;
            speaker.style.animation = `speaker-pulse ${0.2 / intensityFactor}s`;
            
            // Яркие цвета для точек на динамике
            const dots = speakerGrid.querySelectorAll('.speaker-dot');
            dots.forEach((dot, index) => {
                dot.style.animation = 'none';
                dot.offsetHeight;
                dot.style.animation = `glow ${(0.1 + index * 0.03) / intensityFactor}s`;
                dot.style.backgroundColor = getCrazyColor();
            });
        }
        
        // Ручной танец (управляется кнопками)
        function manualDance(moveType) {
            const intensityFactor = intensity / 10;
            
            switch(moveType) {
                case 'body':
                    robotBody.style.animation = 'none';
                    robotBody.offsetHeight;
                    robotBody.style.animation = `body-bounce ${0.5 / intensityFactor}s`;
                    break;
                    
                case 'head':
                    robotHead.style.animation = 'none';
                    robotHead.offsetHeight;
                    robotHead.style.animation = `head-bob ${0.4 / intensityFactor}s`;
                    break;
                    
                case 'leftArm':
                    leftArm.style.animation = 'none';
                    leftArm.offsetHeight;
                    leftArm.style.animation = `arm-swing-left ${0.6 / intensityFactor}s`;
                    break;
                    
                case 'rightArm':
                    rightArm.style.animation = 'none';
                    rightArm.offsetHeight;
                    rightArm.style.animation = `arm-swing-right ${0.6 / intensityFactor}s`;
                    break;
                    
                case 'leftLeg':
                    leftLeg.style.animation = 'none';
                    leftLeg.offsetHeight;
                    leftLeg.style.animation = `leg-lift-left ${0.5 / intensityFactor}s`;
                    break;
                    
                case 'rightLeg':
                    rightLeg.style.animation = 'none';
                    rightLeg.offsetHeight;
                    rightLeg.style.animation = `leg-lift-right ${0.5 / intensityFactor}s`;
                    break;
            }
        }
        
        // Получение цвета для бита
        function getBeatColor() {
            const colors = ['#ff6b6b', '#ffd166', '#ff9e6d', '#ff8e6d'];
            return colors[beatCounter % colors.length];
        }
        
        // Получение цвета для безумного танца
        function getCrazyColor() {
            const colors = ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#ff00ff'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        // Загрузка файлов
        function handleFileSelect(files) {
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                
                // Проверяем тип файла
                if (!file.type.startsWith('audio/')) {
                    alert(`Файл "${file.name}" не является аудиофайлом. Пропускаем.`);
                    continue;
                }
                
                // Создаем URL для файла
                const audioUrl = URL.createObjectURL(file);
                
                // Добавляем в плейлист
                playlist.push({
                    name: file.name.replace(/\.[^/.]+$/, ""), // Убираем расширение
                    file: file,
                    audioUrl: audioUrl,
                    color: getBeatColor()
                });
                
                // Добавляем в список файлов
                addFileToList(file, playlist.length - 1);
            }
            
            // Обновляем счетчик треков
            document.getElementById('track-count').textContent = playlist.length;
            
            // Если это первый загруженный трек, обновляем информацию
            if (playlist.length === 1) {
                updateTrackInfo();
                setActiveFile(0);
                
                // Если музыка играла, переключаем на новый трек
                if (isMusicPlaying) {
                    currentTrackIndex = 0;
                    audioPlayer.src = playlist[0].audioUrl;
                    audioPlayer.play();
                }
            }
            
            // Показываем уведомление
            robotStatus.textContent = `Загружено ${files.length} треков`;
            setTimeout(() => {
                if (!isMusicPlaying) robotStatus.textContent = 'Готов к танцу!';
            }, 3000);
        }
        
        // Добавление файла в список
        function addFileToList(file, index) {
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            fileItem.dataset.index = index;
            
            // Создаем аудио элемент для получения длительности
            const audio = new Audio();
            audio.src = URL.createObjectURL(file);
            
            audio.addEventListener('loadedmetadata', () => {
                const duration = formatDuration(audio.duration);
                
                fileItem.innerHTML = `
                    <i class="fas fa-music"></i>
                    <div class="file-name">${file.name}</div>
                    <div class="file-duration">${duration}</div>
                `;
                
                // Освобождаем URL
                URL.revokeObjectURL(audio.src);
            });
            
            audio.addEventListener('error', () => {
                fileItem.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <div class="file-name">${file.name}</div>
                    <div class="file-duration">Ошибка</div>
                `;
            });
            
            // Обработчик клика для выбора трека
            fileItem.addEventListener('click', function() {
                const index = parseInt(this.dataset.index);
                if (index !== currentTrackIndex) {
                    currentTrackIndex = index;
                    setActiveFile(index);
                    updateTrackInfo();
                    
                    if (isMusicPlaying) {
                        audioPlayer.src = playlist[currentTrackIndex].audioUrl;
                        audioPlayer.play();
                    }
                }
            });
            
            fileList.appendChild(fileItem);
        }
        
        // Установка активного файла в списке
        function setActiveFile(index) {
            const fileItems = document.querySelectorAll('.file-item');
            fileItems.forEach(item => {
                item.classList.remove('active');
            });
            
            if (fileItems[index]) {
                fileItems[index].classList.add('active');
            }
        }
        
        // Форматирование длительности
        function formatDuration(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }
        
        // Обновление информации о треке
        function updateTrackInfo() {
            if (playlist.length > 0) {
                trackTitle.textContent = playlist[currentTrackIndex].name;
                trackArtist.textContent = 'Робот будет танцевать под бит!';
                albumCover.style.background = `linear-gradient(135deg, ${getBeatColor()}, #ffd166)`;
                currentTrack.textContent = playlist[currentTrackIndex].name;
            }
        }
        
        // Обновление прогресса трека
        function updateProgress() {
            if (audioPlayer.duration) {
                const percent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
                progress.style.width = `${percent}%`;
                
                currentTimeEl.textContent = formatDuration(audioPlayer.currentTime);
                durationEl.textContent = formatDuration(audioPlayer.duration);
            }
        }
        
        // Перемотка трека
        function seek(e) {
            const width = this.clientWidth;
            const clickX = e.offsetX;
            const duration = audioPlayer.duration;
            
            if (duration) {
                audioPlayer.currentTime = (clickX / width) * duration;
            }
        }
        
        // Изменение громкости
        function changeVolume() {
            audioPlayer.volume = volumeSlider.value / 100;
        }
        
        // Переключение трека
        function changeTrack(direction) {
            if (playlist.length === 0) return;
            
            currentTrackIndex += direction;
            
            if (currentTrackIndex < 0) {
                currentTrackIndex = playlist.length - 1;
            } else if (currentTrackIndex >= playlist.length) {
                currentTrackIndex = 0;
            }
            
            // Обновляем информацию о треке
            updateTrackInfo();
            setActiveFile(currentTrackIndex);
            
            // Обновляем текущий трек в статусе
            if (isMusicPlaying) {
                currentTrack.textContent = playlist[currentTrackIndex].name;
                
                // Переключаем трек
                audioPlayer.src = playlist[currentTrackIndex].audioUrl;
                audioPlayer.play();
            } else {
                currentTrack.textContent = playlist[currentTrackIndex].name;
            }
            
            // Анимация переключения трека
            albumCover.style.animation = 'pulse 0.5s';
            setTimeout(() => {
                albumCover.style.animation = '';
            }, 500);
        }
        
        // Воспроизведение музыки
        function playMusic() {
            if (playlist.length === 0) {
                alert('Сначала загрузите музыку!');
                return;
            }
            
            if (!isMusicPlaying) {
                if (playlist[currentTrackIndex].audioUrl) {
                    audioPlayer.src = playlist[currentTrackIndex].audioUrl;
                }
                
                audioPlayer.play()
                    .then(() => {
                        isMusicPlaying = true;
                        playIcon.className = 'fas fa-pause';
                        speaker.style.animation = 'speaker-pulse 0.5s infinite';
                        
                        // Инициализируем анализатор
                        initAudioAnalyzer();
                        
                        // Запускаем визуализатор и детектор битов
                        beatCheckInterval = setInterval(updateVisualizer, 50);
                        
                        // Обновляем статус
                        robotStatus.textContent = 'Танцует под бит!';
                        currentTrack.textContent = playlist[currentTrackIndex].name;
                        
                        // Сбрасываем счетчики битов
                        beatCounter = 0;
                        beatTimes = [];
                        beatCount.textContent = '0';
                    })
                    .catch(error => {
                        console.error('Ошибка воспроизведения:', error);
                        alert('Не удалось воспроизвести аудиофайл. Проверьте формат файла.');
                    });
            } else {
                audioPlayer.pause();
                isMusicPlaying = false;
                playIcon.className = 'fas fa-play';
                speaker.style.animation = 'none';
                
                // Останавливаем визуализатор
                clearInterval(beatCheckInterval);
                
                // Обновляем статус
                robotStatus.textContent = 'На паузе';
                currentTrack.textContent = 'На паузе';
            }
        }
        
        // Смена режима танца
        function setDanceMode(mode) {
            currentDanceMode = mode;
            
            // Сбрасываем все анимации
            robotBody.style.animation = 'none';
            robotHead.style.animation = 'none';
            leftArm.style.animation = 'none';
            rightArm.style.animation = 'none';
            leftLeg.style.animation = 'none';
            rightLeg.style.animation = 'none';
            
            // Сбрасываем активные кнопки
            autoBeatBtn.classList.remove('active');
            manualDanceBtn.classList.remove('active');
            crazyDanceBtn.classList.remove('active');
            
            // Устанавливаем новый режим
            switch(mode) {
                case 'auto':
                    autoBeatBtn.classList.add('active');
                    danceMode.textContent = 'Авто-бит';
                    robotStatus.textContent = isMusicPlaying ? 'Танцует под бит!' : 'Готов к танцу под бит';
                    break;
                    
                case 'manual':
                    manualDanceBtn.classList.add('active');
                    danceMode.textContent = 'Ручной танец';
                    robotStatus.textContent = 'Ручное управление танцем';
                    break;
                    
                case 'crazy':
                    crazyDanceBtn.classList.add('active');
                    danceMode.textContent = 'Безумный танец';
                    robotStatus.textContent = isMusicPlaying ? 'Безумно танцует!' : 'Готов к безумному танцу';
                    break;
            }
        }
        
        // Обработчики кнопок режимов танца
        autoBeatBtn.addEventListener('click', () => setDanceMode('auto'));
        manualDanceBtn.addEventListener('click', () => setDanceMode('manual'));
        crazyDanceBtn.addEventListener('click', () => setDanceMode('crazy'));
        
        // Обработчики кнопок ручного танца
        document.addEventListener('keydown', (e) => {
            if (currentDanceMode === 'manual') {
                switch(e.key) {
                    case 'q':
                    case 'й':
                        manualDance('body');
                        break;
                    case 'w':
                    case 'ц':
                        manualDance('head');
                        break;
                    case 'a':
                    case 'ф':
                        manualDance('leftArm');
                        break;
                    case 's':
                    case 'ы':
                        manualDance('rightArm');
                        break;
                    case 'z':
                    case 'я':
                        manualDance('leftLeg');
                        break;
                    case 'x':
                    case 'ч':
                        manualDance('rightLeg');
                        break;
                }
            }
        });
        
        // Обработчики музыкального плеера
        playPauseBtn.addEventListener('click', function() {
            playMusic();
        });
        
        prevBtn.addEventListener('click', function() {
            changeTrack(-1);
        });
        
        nextBtn.addEventListener('click', function() {
            changeTrack(1);
        });
        
        // Когда аудио закончилось, переключаем на следующий трек
        audioPlayer.addEventListener('ended', function() {
            if (playlist.length > 1) {
                changeTrack(1);
            }
        });
        
        // Обновление прогресса трека
        audioPlayer.addEventListener('timeupdate', updateProgress);
        
        // Обработчик перемотки
        progressBar.addEventListener('click', seek);
        
        volumeSlider.addEventListener('input', function() {
            changeVolume();
        });
        
        // Обработчики слайдеров
        sensitivitySlider.addEventListener('input', function() {
            sensitivity = parseInt(this.value);
        });
        
        intensitySlider.addEventListener('input', function() {
            intensity = parseInt(this.value);
        });
        
        // Обработчики загрузки файлов
        selectFilesBtn.addEventListener('click', function() {
            fileInput.click();
        });
        
        fileInput.addEventListener('change', function() {
            if (this.files.length > 0) {
                handleFileSelect(this.files);
                this.value = ''; // Сбрасываем значение, чтобы можно было загружать те же файлы снова
            }
        });
        
        // Drag and drop
        uploadArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', function() {
            this.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
            
            if (e.dataTransfer.files.length > 0) {
                handleFileSelect(e.dataTransfer.files);
            }
        });
        
        // Инициализация
        function init() {
            initVisualizer();
            
            // Задаем начальный цвет для обложки альбома
            albumCover.style.background = `linear-gradient(135deg, #ff6b6b, #ffd166)`;
            
            // Устанавливаем начальный режим
            setDanceMode('auto');
            
            // Информация об управлении
            console.log('Для ручного режима танца используйте клавиши:');
            console.log('Q/Й - качать телом, W/Ц - качать головой');
            console.log('A/Ф - левая рука, S/Ы - правая рука');
            console.log('Z/Я - левая нога, X/Ч - правая нога');
        }
        
        // Инициализация при загрузке
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>